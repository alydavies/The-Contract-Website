{% load games_tags %}

{% for date, event_list in timeline.items %}
  <h4>{{ date }}</h4>
  <ul>
    {% for event in event_list %}
      {% if event.0 == "game"%}
        {% with event.1 as attendance %}
          {% include "games/game_attendance_badge_snippet.html" %}
        {% endwith %}
      {% elif event.0 == "exp_reward" %}
        <li class="css-timeline-item css-timeline-exp">
          <b>{{event.1.get_history_blurb.0}}</b>
          {{event.1.get_history_blurb.1}}
        </li>
      {% elif event.0 == "reward" %}
        <li class="css-timeline-item css-timeline-reward">
          {% with event.1 as reward %}
            {% render_reward reward %}
          {% endwith %}
        </li>
      {% elif event.0 == "crafting" %}
        <li class="css-timeline-item css-timeline-crafting">
          Crafted <b>{{event.1.total_crafted}}</b> items for <b>{{event.1.total_exp_spent}}</b> Experience
          {% if event.1.power_quantity %}
            <ul>
              {% for pq in event.1.power_quantity %}
                <li><b>{{pq.quantity}} </b>
                  <a href="{% url 'powers:powers_view_power' pq.power.id %}">{{pq.power.name}}</a>
                  <i class="text-muted">({{pq.quantity_free}} free)</i></li>
              {% endfor %}
            </ul>
          {% endif %}
        </li>
      {% else %}
        {% for phrase in event.1 %}
          <li class="css-timeline-item css-timeline-exp">
            <b>{{phrase.0}} Exp:</b> {{phrase.1}}
          </li>
        {% endfor %}
      {% endif %}
    {% endfor %}
  </ul>
  {% empty %}
  <h4>{{character.name}} Has never edited their stats or attended a Contract</h4>
{% endfor %}
